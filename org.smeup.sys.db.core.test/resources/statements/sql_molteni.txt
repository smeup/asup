SELECT * FROM FILE_MF.MF_TABRU WHERE TIPTAB NOT IN('P1','P2','P3','P4')
SELECT * FROM FILE_MF.MF_TABNC
SELECT * FROM FILE_MF.MF_TABCL
SELECT * FROM FILE_MF.MF_TABRU WHERE TIPTAB NOT IN('P1','P2','P3','P4')
SELECT * FROM FILE_MF.MF_TABNC
SELECT * FROM FILE_MF.MF_TABCL
SELECT * FROM FILE_MF.MF_TABNC WHERE TRETNC = 'AS' AND (ANNTNC = '') ORDER BY TRETNC,CODTNC
SELECT * FROM FILE_MF.MF_TABNC WHERE TRETNC = 'AS' AND (ANNTNC = '') ORDER BY TRETNC,CODTNC
SELECT * FROM FILE_MF.MF_TABNC WHERE TRETNC = 'AS' AND (ANNTNC = '') ORDER BY TRETNC,CODTNC
SELECT * FROM MFDITTA.VARIABILI WHERE SIGVAR = 'MF' ORDER BY NUMVAR
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_MF.MF_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT KEYCLV,DESCLV FROM FILE_MF.MF_CAULAV ORDER BY KEYCLV
SELECT * FROM FILE_MF.MF_DIP WHERE LICDIP = 0 ORDER BY DESDIP, KEYDIP
SELECT * FROM FILE_II.II_TABRU WHERE TIPTAB NOT IN('P1','P2','P3','P4')
SELECT * FROM FILE_II.II_TABNC
SELECT * FROM FILE_II.II_TABCL
SELECT * FROM FILE_II.II_TABNC WHERE TRETNC = 'AS' AND (ANNTNC = '') ORDER BY TRETNC,CODTNC
SELECT * FROM FILE_II.II_TABNC WHERE TRETNC = 'AS' AND (ANNTNC = '') ORDER BY TRETNC,CODTNC
SELECT * FROM FILE_II.II_TABNC WHERE TRETNC = 'AS' AND (ANNTNC = '') ORDER BY TRETNC,CODTNC
SELECT * FROM MFDITTA.VARIABILI WHERE SIGVAR = 'AM' ORDER BY NUMVAR
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT KEYCLV,DESCLV FROM FILE_II.II_CAULAV ORDER BY KEYCLV
SELECT * FROM FILE_II.II_DIP WHERE LICDIP = 0 ORDER BY DESDIP, KEYDIP
SELECT TREANA,CODANA,RSOANA, NMGANA, INDANA,LOCANA,PROANA,CAPANA,ESTANA, RSOANS,IN2ANS FROM FILE_II.II_ANAGR LEFT JOIN FILE_II.II_ANASU ON TREANA = TREANS AND CODANA = CODANS AND ANNANS = ' '  WHERE TREANA=1 AND ANNANA = '' ORDER BY RSOANA, CODANA
SELECT TREANA,CODANA,RSOANA, NMGANA, INDANA,LOCANA,PROANA,CAPANA,ESTANA, RSOANS,IN2ANS FROM FILE_II.II_ANAGR LEFT JOIN FILE_II.II_ANASU ON TREANA = TREANS AND CODANA = CODANS AND ANNANS = ' '  WHERE TREANA=2 AND ANNANA = '' ORDER BY RSOANA, CODANA
SELECT LEFT(DATTNC,96) AS ETICHETTE FROM FILE_II.II_TABNC WHERE ANNTNC = ' ' AND TRETNC = 'TD' AND TRIM(BOTH FROM SUBSTR(CODTNC, 12, 2)) = '30' ORDER BY SUBSTR(CODTNC, 12, 2),CODTNC
SELECT * FROM FILE_II.II_CQAUT WHERE AUTQUA <> 0 AND (  (UPPER(UTEQUA) = 'FRANCOL' OR UPPER(UTEQUA) = '$JAVA' ) ) ORDER BY KEYQUA,UTEQUA
SELECT * FROM FILE_II.II_ASSDV ORDER BY KEYDIV
SELECT TRIM(SUBSTR(CODTCL, 13, 1)) AS CODICE, TRIM(DESTCL) AS DESCRIZIONE FROM FILE_II.II_TABCL WHERE TIPTCL='TN' AND ANNTCL=' ' AND TRIM(SUBSTR(CODTCL, 9, 4)) = '' ORDER BY DESCRIZIONE
SELECT SUBSTR(RECORD1.CODTNC, 12, 2) AS CODICE, RECORD1.DATTNC AS DATI, RECORD2.DATTNC AS DATI2 FROM FILE_II.II_TABNC RECORD1 LEFT JOIN FILE_II.II_TABNC RECORD2 ON SUBSTR(RECORD2.CODTNC, 12, 2) = SUBSTR(RECORD1.CODTNC, 12, 2) AND RECORD1.TRETNC = RECORD2.TRETNC AND SUBSTR(RECORD2.CODTNC, 1, 1) = '2' and  RECORD2.ANNTNC='' WHERE RECORD1.TRETNC='DO' AND SUBSTR(RECORD1.DATTNC, 53, 1) IN ('O') AND SUBSTR(RECORD1.DATTNC, 45, 1)= '1' AND RECORD1.ANNTNC=' ' ORDER BY CODICE
SELECT LEFT(DATTNC,96) AS ETICHETTE FROM FILE_II.II_TABNC WHERE ANNTNC = ' ' AND TRETNC = 'TD' AND TRIM(BOTH FROM SUBSTR(CODTNC, 12, 2)) = '50' ORDER BY SUBSTR(CODTNC, 12, 2),CODTNC
SELECT SUBSTR(CODTNC, 13, 1) AS CODICE, LEFT(DATTNC, 25) AS DESCRIZIONE, SUBSTR(DATTNC, 39, 1) AS TIPOLISTA, SUBSTR(DATTNC, 40, 1) AS FLAGDTD, SUBSTR(DATTNC, 41, 2) AS MAGAZZINO, SUBSTR(DATTNC, 44, 1) AS FLGGESTSEP, SUBSTR(DATTNC, 49, 1) AS TIPOCOMMESSA, SUBSTR(DATTNC, 50, 1) AS CLASSECOMMESSA, SUBSTR(DATTNC, 51, 4) AS PROGRINIZ FROM FILE_II.II_TABNC WHERE TRETNC='SC' AND ANNTNC=' ' ORDER BY 1
SELECT * FROM FILE_II.II_CDC ORDER BY KEYCDC
WITH NOTE AS (SELECT DISTINCT ARTRMO FROM FILE_II.II_PARMO) , ALLEGATI AS (SELECT CODALA, COUNT(CODALA) AS NUMERO_ALLEGATI FROM FILE_II.II_ALLART GROUP BY CODALA)  SELECT FILE_II.II_PARTI.*,ARTRMO,ALLEGATI.NUMERO_ALLEGATI,DVDDBT,CIMMST FROM FILE_II.II_PARTI  LEFT JOIN NOTE ON CODPAR = ARTRMO  LEFT JOIN ALLEGATI ON CODPAR=CODALA LEFT JOIN FILE_II.II_DBTES ON ASSDBT = CODPAR AND SIGDBT = ''  AND REVDBT = ''  AND ANNDBT='' LEFT JOIN FILE_II.II_MSTIM ON ARTMST=CODPAR WHERE MATPAR LIKE 'CA%' AND (DIMPAR = '030') AND (TIPPAR = 'W') AND (PRNPAR = '015') AND (ANNPAR = ' ') ORDER BY CODPAR OPTIMIZE FOR 501 ROWS
DELETE FROM FILE_II.II_ANAAR WHERE NPCAAR='FRANCOL37845   '
INSERT INTO FILE_II.II_ANAAR(NPCAAR, ARTAAR) SELECT DISTINCT 'FRANCOL37845   ', CODPAR FROM FILE_II.II_PARTI LEFT OUTER JOIN FILE_II.II_DTECN PADRE ON CODPAR=CODDIS AND ' '=ANNDIS  WHERE ANNPAR = ' ' AND (ASSPAR = 'A' OR (TPADIS = 'F' OR TPADIS = 'A')) AND CODPAR LIKE 'CA030W015FFA1%'
SELECT NPCAAR, ARTAAR, DE1AAR, DE2AAR, DE3AAR, PSFAAR, EU3AAR, ESDAAR, ORCAAR, ORFAAR, ORPAAR, IMPAAR, GRDAAR, DISAAR, DVDAAR, SIGAAR, CODAAR, REVAAR, TPAPAR, TLIPAR FROM FILE_II.II_ANAAR INNER JOIN FILE_II.II_PARTI  ON ARTAAR = CODPAR WHERE NPCAAR = 'FRANCOL37845   '
SELECT TIPADB, CPNADB, DESADB, RMEADB, UMMADB, QTAADB, CUNADB, IMPADB FROM FILE_II.II_ANADB WHERE NPCADB = 'FRANCOL37845' AND (ARTADB = 'CA030W015FFA1')
SELECT NPCAPR, TIPAPR, CPNAPR, DESAPR, NOTAPR, RMEAPR, UMMAPR, PDBAPR, QTTAPR, CUNAPR, IMPAPR, PDTAPR, DUFAPR, COMAPR, POSAPR, RCPAPR, PRGAPR, NPZAPR, CPZAPR, ARTAPR FROM FILE_II.II_ANAPR WHERE NPCAPR = 'FRANCOL37845' AND (ARTAPR = 'CA030W015FFA1') ORDER BY DUFAPR DESC, PRGAPR
SELECT S.*,DE1PAR,DE2PAR,DE3PAR FROM FILE_II.II_SALDI S left join FILE_II.II_PARTI on annpar='' and codsal=codpar WHERE CODSAL LIKE 'CA030W015FFA1%' AND (ANNSAL = ' ') ORDER BY MAGSAL,CODSAL
SELECT PFIN.CODPAR AS "PFIN.CODPAR", PFIN.DE1PAR AS "PFIN.DE1PAR", PFIN.DE2PAR AS "PFIN.DE2PAR", PFIN.DE3PAR AS "PFIN.DE3PAR", PFIN.PSFPAR AS "PFIN.PSFPAR", PGRE.CODPAR AS "PGRE.CODPAR", PGRE.DESPAR AS "PGRE.DESPAR", PGRE.PSFPAR AS "PGRE.PSFPAR", PMP.CODPAR AS "PMP.CODPAR", PMP.DESPAR AS "PMP.DESPAR", DBGRE_MP.QTADBS AS "DBGRE_MP.QTADBS", PFOR.CODPAR AS "PFOR.CODPAR", PFOR.DESPAR AS "PFOR.DESPAR", PFOR.PSFPAR AS "PFOR.PSFPAR" FROM FILE_II.II_PARTI PFIN INNER JOIN FILE_II.II_DBSTA DBFIN ON PFIN.CODPAR = DBFIN.ASSDBS AND DBFIN.TIPDBS = 1 AND DBFIN.ANNDBS = ' ' INNER JOIN FILE_II.II_PARTI PGRE ON DBFIN.CPNDBS = PGRE.CODPAR AND PGRE.RMEPAR = 30 INNER JOIN FILE_II.II_DBSTA DBGRE_MP ON PGRE.CODPAR = DBGRE_MP.ASSDBS AND DBGRE_MP.TIPDBS = 1 AND DBGRE_MP.ANNDBS = ' '  INNER JOIN FILE_II.II_PARTI PMP ON DBGRE_MP.CPNDBS = PMP.CODPAR AND PMP.RMEPAR = 20 LEFT JOIN FILE_II.II_DBSTA DBGRE_FOR ON PGRE.CODPAR = DBGRE_FOR.ASSDBS AND DBGRE_FOR.CPNDBS LIKE '%ยง%' AND DBGRE_FOR.TIPDBS = 1 AND DBGRE_FOR.ANNDBS = ' ' LEFT JOIN FILE_II.II_PARTI PFOR ON DBGRE_FOR.CPNDBS = PFOR.CODPAR WHERE PFIN.CODPAR LIKE 'CA030W015FFA1%' ORDER BY PFIN.CODPAR OPTIMIZE FOR 501 ROWS
SELECT FILE_II.II_PARTI.*,DVDDBT,CIMMST FROM FILE_II.II_PARTI  LEFT JOIN FILE_II.II_DBTES ON ASSDBT = CODPAR AND SIGDBT = ''  AND REVDBT = ''  AND ANNDBT='' LEFT JOIN FILE_II.II_MSTIM ON ARTMST=CODPAR WHERE CODPAR LIKE 'CA030W015FFA1%' AND (RMEPAR = 40) AND (SOSPAR = '') AND (ANNPAR = ' ') ORDER BY CODPAR OPTIMIZE FOR 501 ROWS
SELECT DVDDBT AS DVD, ' ' AS COM, 0  AS POS, CPNDBS AS COD, DESPAR AS DES, UMMDBS AS UMM, QTADBS AS QTA, PHHDBS AS PHH, RMEPAR FROM FILE_II.II_DBSTA INNER JOIN FILE_II.II_DBTES ON SIGDBS = SIGDBT AND ASSDBS = ASSDBT  AND REVDBS = REVDBT INNER JOIN FILE_II.II_PARTI  ON CPNDBS = CODPAR AND ' ' = ANNPAR WHERE ANNDBS = ' ' AND ASSDBS = 'CA030W015FFA1' ORDER BY SEQDBS, PRGDBS
SELECT TRIM(BOTH FROM DATTNC) AS UNITAS FROM FILE_II.II_TABNC WHERE ANNTNC = ' ' AND TRETNC = 'UM'
SELECT * FROM FILE_II.II_DBMEM WHERE SIGDBM = '' AND (UPPER(ASSDBM) = 'CA030W015FFA1') AND (UPPER(REVDBM) = '') AND (PRGDBM = 0) ORDER BY SIGDBM, ASSDBM, REVDBM, PRGDBM, SIGDBM,ASSDBM,REVDBM,PRGDBM
SELECT SUBSTR(RECORD1.CODTNC, 12, 2) AS CODICE, RECORD1.DATTNC AS DATI, RECORD2.DATTNC AS DATI2 FROM FILE_II.II_TABNC RECORD1 LEFT JOIN FILE_II.II_TABNC RECORD2 ON SUBSTR(RECORD2.CODTNC, 12, 2) = SUBSTR(RECORD1.CODTNC, 12, 2) AND RECORD1.TRETNC = RECORD2.TRETNC AND SUBSTR(RECORD2.CODTNC, 1, 1) = '2' and  RECORD2.ANNTNC='' WHERE RECORD1.TRETNC='DO' AND SUBSTR(RECORD1.DATTNC, 53, 1) IN ('O') AND SUBSTR(RECORD1.DATTNC, 45, 1)= '1' AND RECORD1.ANNTNC=' ' AND SUBSTR(RECORD1.DATTNC, 80, 1)= ' ' ORDER BY CODICE
SELECT LEFT(DATTNC,112) AS ETICHETTE FROM FILE_II.II_TABNC WHERE ANNTNC = ' ' AND TRETNC = 'TD' AND TRIM(BOTH FROM SUBSTR(CODTNC, 12, 2)) = '01' ORDER BY SUBSTR(CODTNC, 12, 2),CODTNC
SELECT LEFT(DATTNC,112) AS ETICHETTE FROM FILE_II.II_TABNC WHERE ANNTNC = ' ' AND TRETNC = 'TD' AND TRIM(BOTH FROM SUBSTR(CODTNC, 12, 2)) = '02' ORDER BY SUBSTR(CODTNC, 12, 2),CODTNC
WITH ALLEGATI AS (SELECT CODADT, COUNT(CODADT) AS NUMERO_ALLEGATI FROM FILE_II.II_ALLDT  GROUP BY CODADT) , NOTE_PRODUZIONE AS  (SELECT KCOCNO,COUNT(KCOCNO) AS NUMERO_RIGHE,MAX(RIGCNO) AS RIGA FROM FILE_II.II_COMNP WHERE ANNCNO = '' GROUP BY KCOCNO)  SELECT FILE_II.II_COMME.*,FILE_II.II_ANAGR.RSOANA,ALLEGATI.NUMERO_ALLEGATI,NOTE_PRODUZIONE.NUMERO_RIGHE,NOTE_PRODUZIONE.RIGA FROM FILE_II.II_COMME  LEFT JOIN FILE_II.II_ANAGR ON ANNANA='' AND CLICOM=CODANA AND TREANA=1 LEFT JOIN ALLEGATI ON KEYCOM=ALLEGATI.CODADT LEFT JOIN NOTE_PRODUZIONE ON KEYCOM=KCOCNO WHERE ANNCOM = ' ' AND (EXISTS (SELECT * FROM FILE_II.II_DTECN WHERE COMDIS = KEYCOM AND DCRDIS >= 20130101 AND ANNDIS = ' ')) ORDER BY KEYCOM OPTIMIZE FOR 501 ROWS
WITH ALLEGATI AS (SELECT CODADT, COUNT(CODADT) AS NUMERO_ALLEGATI FROM FILE_II.II_ALLDT  GROUP BY CODADT) , NOTE_PRODUZIONE AS  (SELECT KCOCNO,COUNT(KCOCNO) AS NUMERO_RIGHE,MAX(RIGCNO) AS RIGA FROM FILE_II.II_COMNP WHERE ANNCNO = '' GROUP BY KCOCNO)  SELECT FILE_II.II_COMME.*,FILE_II.II_ANAGR.RSOANA,ALLEGATI.NUMERO_ALLEGATI,NOTE_PRODUZIONE.NUMERO_RIGHE,NOTE_PRODUZIONE.RIGA FROM FILE_II.II_COMME  LEFT JOIN FILE_II.II_ANAGR ON ANNANA='' AND CLICOM=CODANA AND TREANA=1 LEFT JOIN ALLEGATI ON KEYCOM=ALLEGATI.CODADT LEFT JOIN NOTE_PRODUZIONE ON KEYCOM=KCOCNO WHERE ANNCOM = ' ' AND (EXISTS (SELECT * FROM FILE_II.II_DTECN WHERE COMDIS = KEYCOM AND DCRDIS >= 20130101 AND ANNDIS = ' ')) ORDER BY KEYCOM OPTIMIZE FOR 501 ROWS
SELECT TREANA,CODANA,RSOANA, NMGANA, INDANA,LOCANA,PROANA,CAPANA,ESTANA, RSOANS,IN2ANS FROM FILE_II.II_ANAGR LEFT JOIN FILE_II.II_ANASU ON TREANA = TREANS AND CODANA = CODANS AND ANNANS = ' '  WHERE TREANA=1 AND CODANA=702 AND ANNANA = '' ORDER BY RSOANA, CODANA
SELECT TIPADT,CODADT,POSADT,RIGADT,SEQADT,DORADT,OGGADT,EXTADT,NOTADT,MITADT,DSTADT,ANTADT,USRADT,TI2ADT, length(BLBADT) as LENBLOB,KEYCOM,DE1COM,DE2COM,DE3COM,DE4COM,STACOM,DSTCOM,DCCCOM,MACCOM,MTRCOM,CRICOM,RESCOM,RE1COM,RE2COM,RE4COM,LINCOM,NSRCOM,CLICOM,RSOANA,RSOANA FROM FILE_II.II_ALLDT A INNER JOIN FILE_II.II_COMME ON ANNCOM='' AND KEYCOM=CODADT LEFT JOIN FILE_II.II_ANAGR ON ANNANA='' AND TREANA = 1 AND CODANA=CLICOM WHERE CODADT = '49000' AND (POSADT = 0) ORDER BY TIPADT,CODADT,POSADT,SEQADT,RIGADT OPTIMIZE FOR 1 ROWS
SELECT KEYCDC AS CODICE,TRIM(TRAILING FROM DESCDC) AS DESCRIZIONE FROM FILE_II.II_CDC UNION SELECT DISTINCT CDACDA, TRIM(TRAILING FROM DESCDA) FROM FILE_II.II_TCCDA ORDER BY 1
SELECT DISTINCT TRIM(BOTH FROM KEYPVO) AS CODICE, TRIM(TRAILING FROM DESPVO) AS DESCRIZIONE FROM FILE_II.II_TCPIAVO ORDER BY 1
SELECT DISTINCT TRIM(BOTH FROM KEYBAS) AS CODICE, TRIM(TRAILING FROM DESBAS) AS DESCRIZIONE FROM FILE_II.II_TCBASI ORDER BY 1
SELECT SUBSTR(RECORD1.CODTNC, 12, 2) AS CODICE, RECORD1.DATTNC AS DATI, RECORD2.DATTNC AS DATI2 FROM FILE_II.II_TABNC RECORD1 LEFT JOIN FILE_II.II_TABNC RECORD2 ON SUBSTR(RECORD2.CODTNC, 12, 2) = SUBSTR(RECORD1.CODTNC, 12, 2) AND SUBSTR(RECORD2.CODTNC, 1, 1) = '2' and  RECORD2.ANNTNC='' WHERE RECORD1.TRETNC='DO' AND SUBSTR(RECORD1.DATTNC, 53, 1) IN ('B','R') AND SUBSTR(RECORD1.DATTNC, 45, 1)= '1' AND RECORD1.ANNTNC=' ' AND SUBSTR(RECORD1.DATTNC, 46, 1) <> '1' ORDER BY CODICE
SELECT MIN(DBOORD) AS DATADDT FROM FILE_II.II_RIGBO JOIN FILE_II.II_MODBO ON ANNORD=''  AND MAGORD=TDORIG AND ORDORD=NUDRIG AND OR2ORD=ZNORIG WHERE ANNRIG = ' ' AND COMRIG='49000' AND DBOORD > 0 AND TDORIG IN (3,4,5,7,15,16) GROUP BY COMRIG
WITH DTLEG AS (SELECT COMDTL,POCDTL,MIN(PODDTL) AS PODDTL FROM FILE_II.II_DTLEG WHERE ANNDTL='' GROUP BY COMDTL,POCDTL) SELECT FILE_II.II_COMGR.*,C.KEYCOM AS C_KEYCOM,C.DE1COM AS C_DE1COM,C.DE2COM AS C_DE2COM,C.DE3COM AS C_DE3COM,C.DE4COM AS C_DE4COM,C.STACOM AS C_STACOM,C.DSTCOM AS C_DSTCOM,C.DCCCOM AS C_DCCCOM,C.MACCOM AS C_MACCOM,C.MTRCOM AS C_MTRCOM,C.CRICOM AS C_CRICOM,C.RESCOM AS C_RESCOM,C.RE1COM AS C_RE1COM,C.RE2COM AS C_RE2COM,C.RE4COM AS C_RE4COM,C.LINCOM AS C_LINCOM,C.NSRCOM AS C_NSRCOM,C.CLICOM AS C_CLICOM,A.RSOANA AS A_RSOANA,C_DEST.KEYCOM AS C_DEST_KEYCOM,C_DEST.DE1COM AS C_DEST_DE1COM,C_DEST.DE2COM AS C_DEST_DE2COM,C_DEST.DE3COM AS C_DEST_DE3COM,C_DEST.DE4COM AS C_DEST_DE4COM,C_DEST.STACOM AS C_DEST_STACOM,C_DEST.DSTCOM AS C_DEST_DSTCOM,C_DEST.DCCCOM AS C_DEST_DCCCOM,C_DEST.MACCOM AS C_DEST_MACCOM,C_DEST.MTRCOM AS C_DEST_MTRCOM,C_DEST.CRICOM AS C_DEST_CRICOM,C_DEST.RESCOM AS C_DEST_RESCOM,C_DEST.RE1COM AS C_DEST_RE1COM,C_DEST.RE2COM AS C_DEST_RE2COM,C_DEST.RE4COM AS C_DEST_RE4COM,C_DEST.LINCOM AS C_DEST_LINCOM,C_DEST.NSRCOM AS C_DEST_NSRCOM,C_DEST.CLICOM AS C_DEST_CLICOM,A_DEST.RSOANA AS A_DEST_RSOANA,DESPAR,PODDTL FROM FILE_II.II_COMGR LEFT JOIN FILE_II.II_PARTI ON CODGRU = CODPAR AND ANNPAR = ' ' LEFT JOIN FILE_II.II_COMME AS C ON KCOGRU = C.KEYCOM AND C.ANNCOM = ' ' LEFT JOIN FILE_II.II_COMME AS C_DEST ON CDEGRU = C_DEST.KEYCOM AND C_DEST.ANNCOM = ' ' LEFT JOIN FILE_II.II_ANAGR AS A ON A.TREANA = 1 AND A.CODANA = C.CLICOM AND A.ANNANA=' 'LEFT JOIN FILE_II.II_ANAGR AS A_DEST ON A_DEST.TREANA = 1 AND A_DEST.CODANA = C_DEST.CLICOM AND A_DEST.ANNANA=' 'LEFT JOIN DTLEG ON KCOGRU=COMDTL AND KPRGRU=POCDTL WHERE KCOGRU = '49000' AND (ANNGRU = ' ') ORDER BY KCOGRU,KPRGRU
SELECT SUBSTR(CODTNC, 13, 1) AS CODICE, LEFT(DATTNC, 25) AS DESCRIZIONE, SUBSTR(DATTNC, 39, 1) AS TIPOLISTA, SUBSTR(DATTNC, 40, 1) AS FLAGDTD, SUBSTR(DATTNC, 41, 2) AS MAGAZZINO, SUBSTR(DATTNC, 44, 1) AS FLGGESTSEP, SUBSTR(DATTNC, 49, 1) AS TIPOCOMMESSA, SUBSTR(DATTNC, 50, 1) AS CLASSECOMMESSA, SUBSTR(DATTNC, 51, 4) AS PROGRINIZ FROM FILE_II.II_TABNC WHERE TRETNC='SC' AND ANNTNC=' ' ORDER BY 1
SELECT TIPADT,CODADT,POSADT,RIGADT,SEQADT,DORADT,OGGADT,EXTADT,NOTADT,MITADT,DSTADT,ANTADT,USRADT,TI2ADT, length(BLBADT) as LENBLOB,KEYCOM,DE1COM,DE2COM,DE3COM,DE4COM,STACOM,DSTCOM,DCCCOM,MACCOM,MTRCOM,CRICOM,RESCOM,RE1COM,RE2COM,RE4COM,LINCOM,NSRCOM,CLICOM,RSOANA,RSOANA FROM FILE_II.II_ALLDT A INNER JOIN FILE_II.II_COMME ON ANNCOM='' AND KEYCOM=CODADT LEFT JOIN FILE_II.II_ANAGR ON ANNANA='' AND TREANA = 1 AND CODANA=CLICOM WHERE   (TIPADT = 'CG' OR TIPADT = 'CO' OR TIPADT = 'MR' OR TIPADT = 'OF' )  AND (CODADT = '49000') AND (POSADT = 0) ORDER BY TIPADT, TI2ADT, SEQADT, EXTADT, OGGADT, TIPADT,CODADT,POSADT,SEQADT,RIGADT
select COMDIS,POSDIS,PASDIS,SEQDIS,CODDIS,ASSDIS,TIPDIS,LANDIS,TPADIS,TLIDIS,NBODIS,CCIDIS,QTTDIS,DCODIS,ITBDIS,CMPDIS,CODPAR,DESPAR,DE1PAR,DE2PAR,DE3PAR,UMMPAR,TPAPAR,TLIPAR,FAMPAR,CSTPAR,EU3PAR,RMEPAR from FILE_II.II_dtecn left join FILE_II.II_parti on coddis=codpar and annpar='' where COMDIS = '49000' and anndis='' ORDER BY PASDIS, SEQDIS, POSDIS, PASDIS,SEQDIS, POSDIS
SELECT * FROM FILE_II.II_DTMEM WHERE COMDME = '49000' AND (POSDME = 0) ORDER BY COMDME, POSDME, TIPDME, COMDME,POSDME
SELECT TIPADT,CODADT,POSADT,RIGADT,SEQADT,DORADT,OGGADT,EXTADT,NOTADT,MITADT,DSTADT,ANTADT,USRADT,TI2ADT, length(BLBADT) as LENBLOB,KEYCOM,DE1COM,DE2COM,DE3COM,DE4COM,STACOM,DSTCOM,DCCCOM,MACCOM,MTRCOM,CRICOM,RESCOM,RE1COM,RE2COM,RE4COM,LINCOM,NSRCOM,CLICOM,RSOANA,RSOANA FROM FILE_II.II_ALLDT A INNER JOIN FILE_II.II_COMME ON ANNCOM='' AND KEYCOM=CODADT LEFT JOIN FILE_II.II_ANAGR ON ANNANA='' AND TREANA = 1 AND CODANA=CLICOM WHERE   (TIPADT = 'CG' OR TIPADT = 'CO' OR TIPADT = 'MR' OR TIPADT = 'OF' )  AND (CODADT = '49000') AND (POSADT = 0) ORDER BY TIPADT, TI2ADT, SEQADT, EXTADT, OGGADT, TIPADT,CODADT,POSADT,SEQADT,RIGADT
SELECT * FROM FILE_II.II_DTMEM WHERE COMDME = '49000' AND (POSDME = 240) ORDER BY COMDME, POSDME, TIPDME, COMDME,POSDME
SELECT TIPADT,CODADT,POSADT,RIGADT,SEQADT,DORADT,OGGADT,EXTADT,NOTADT,MITADT,DSTADT,ANTADT,USRADT,TI2ADT, length(BLBADT) as LENBLOB,KEYCOM,DE1COM,DE2COM,DE3COM,DE4COM,STACOM,DSTCOM,DCCCOM,MACCOM,MTRCOM,CRICOM,RESCOM,RE1COM,RE2COM,RE4COM,LINCOM,NSRCOM,CLICOM,RSOANA,RSOANA FROM FILE_II.II_ALLDT A INNER JOIN FILE_II.II_COMME ON ANNCOM='' AND KEYCOM=CODADT LEFT JOIN FILE_II.II_ANAGR ON ANNANA='' AND TREANA = 1 AND CODANA=CLICOM WHERE   (TIPADT = 'CG' OR TIPADT = 'CO' OR TIPADT = 'MR' OR TIPADT = 'OF' )  AND (CODADT = '49000') AND (POSADT = 240) ORDER BY TIPADT, TI2ADT, SEQADT, EXTADT, OGGADT, TIPADT,CODADT,POSADT,SEQADT,RIGADT
SELECT TIPADT,CODADT,POSADT,RIGADT,SEQADT,DORADT,OGGADT,EXTADT,NOTADT,MITADT,DSTADT,ANTADT,USRADT,TI2ADT, length(BLBADT) as LENBLOB,KEYCOM,DE1COM,DE2COM,DE3COM,DE4COM,STACOM,DSTCOM,DCCCOM,MACCOM,MTRCOM,CRICOM,RESCOM,RE1COM,RE2COM,RE4COM,LINCOM,NSRCOM,CLICOM,RSOANA,RSOANA FROM FILE_II.II_ALLDT A INNER JOIN FILE_II.II_COMME ON ANNCOM='' AND KEYCOM=CODADT LEFT JOIN FILE_II.II_ANAGR ON ANNANA='' AND TREANA = 1 AND CODANA=CLICOM WHERE   (TIPADT = 'CG' OR TIPADT = 'CO' OR TIPADT = 'MR' OR TIPADT = 'OF' )  AND (CODADT = '49000') AND (POSADT = 0) ORDER BY TIPADT, TI2ADT, SEQADT, EXTADT, OGGADT, TIPADT,CODADT,POSADT,SEQADT,RIGADT
WITH ORDINI_NON_EVASI AS (SELECT COMRIG AS COM_ORDINE, PCORIG AS POS_ORDINE,SUM(QTARIG) AS QTANONEVASI,SUM(QTA2-QTA3) AS QTARICEVNONEVASI FROM FILE_II.II_RIGOF JOIN FILE_II.II_MODOF ON TDORIG = MAGORD AND NUDRIG = ORDORD AND ZNORIG = OR2ORD AND ANNORD = ' ' JOIN FILE_II.II_COMME ON COMRIG = KEYCOM AND ANNCOM = ' '  AND STACOM = ' ' WHERE ANNRIG = ' ' AND IMPORD = '' AND EVARIG = '' GROUP BY  COMRIG,PCORIG), ORDINI_EVASI AS (SELECT COMRIG AS COM_ORDINE_EVASO, PCORIG AS POS_ORDINE_EVASO,SUM(QTARIG) AS QTAEVASI,SUM(QTA2-QTA3) AS QTARICEVEVASI FROM FILE_II.II_RIGOF JOIN FILE_II.II_MODOF ON TDORIG = MAGORD AND NUDRIG = ORDORD AND ZNORIG = OR2ORD AND ANNORD = ' ' JOIN FILE_II.II_COMME ON COMRIG = KEYCOM AND ANNCOM = ' ' AND STACOM = ' ' WHERE ANNRIG = ' ' AND IMPORD = '' AND EVARIG > '' GROUP BY  COMRIG,PCORIG), OFFERTE AS (SELECT COMRIG AS COM_OFFERTA, PCORIG AS POS_OFFERTA FROM FILE_II.II_RIGOF JOIN FILE_II.II_MODOF ON TDORIG = MAGORD AND NUDRIG = ORDORD AND ZNORIG = OR2ORD AND ANNORD = ' ' JOIN FILE_II.II_COMME ON COMRIG = KEYCOM AND ANNCOM = ' ' AND STACOM = ' ' WHERE ANNRIG = ' ' AND IMPORD = '1' GROUP BY  COMRIG,PCORIG), ALLEGATI AS (SELECT CODADT, POSADT, COUNT(CODADT) AS NUMERO_ALLEGATI FROM FILE_II.II_ALLDT  GROUP BY CODADT,POSADT)  SELECT DT.*,PA.*,COM.*,NOTE.*,SAL.*,ANAG.RSOANA, ORDINI_NON_EVASI.*, ORDINI_EVASI.*, OFFERTE.*, PAS.CODPAR AS PAS_CODPAR, PAS.DESPAR AS PAS_DESPAR, PAS.DE1PAR AS PAS_DE1PAR, PAS.DE2PAR AS PAS_DE2PAR, PAS.DE3PAR AS PAS_DE3PAR, ALLEGATI.NUMERO_ALLEGATI FROM FILE_II.II_DTECN DT  INNER JOIN FILE_II.II_PARTI PA ON DT.CODDIS = PA.CODPAR AND ' ' = PA.ANNPAR INNER JOIN FILE_II.II_COMME COM ON DT.COMDIS = COM.KEYCOM AND ' ' = COM.ANNCOM AND STACOM = ' ' LEFT JOIN FILE_II.II_ANAGR ANAG ON ANNANA='' AND COM.CLICOM=CODANA AND TREANA=1 LEFT JOIN FILE_II.II_DTNOT NOTE ON DT.COMDIS = COMDTN AND DT.POSDIS = POSDTN AND ' ' = ANNDTN LEFT JOIN FILE_II.II_SALDI SAL ON DT.CODDIS = SAL.CODSAL AND DT.MAGDIS = SAL.MAGSAL AND SAL.ANNSAL='' LEFT JOIN ORDINI_NON_EVASI ON DT.COMDIS=COM_ORDINE AND DT.POSDIS=POS_ORDINE LEFT JOIN ORDINI_EVASI ON DT.COMDIS=COM_ORDINE_EVASO AND DT.POSDIS=POS_ORDINE_EVASO LEFT JOIN OFFERTE ON DT.COMDIS=COM_OFFERTA AND DT.POSDIS=POS_OFFERTA LEFT JOIN FILE_II.II_DTECN ASSIEME ON ASSIEME.COMDIS=DT.COMDIS AND ASSIEME.POSDIS=DT.PASDIS LEFT JOIN FILE_II.II_PARTI PAS ON ASSIEME.CODDIS = PAS.CODPAR AND ' ' = PAS.ANNPAR LEFT JOIN ALLEGATI ON DT.COMDIS = CODADT AND DT.POSDIS = POSADT WHERE STACOM = ' ' AND (  (DT.FCODIS = '' ) ) AND (PA.MATPAR LIKE 'CA%') AND (PA.DIMPAR = '030') AND (PA.TIPPAR = 'W') AND (PA.PRNPAR = '015') AND (DT.ANNDIS = ' ') ORDER BY DT.COMDIS,DT.POSDIS OPTIMIZE FOR 501 ROWS
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = 'PROVA5' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '47745' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '47949' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '47969' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48049' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48105' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48156' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48213' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48221' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48230' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48262' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48267' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48281' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48283' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48399' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48402' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48405' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48408' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48463' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48531' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48589' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48659' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48663' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48680' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48720' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48849' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48853' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48863' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48916' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48918' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '48963' ORDER BY COMDME,POSDME
SELECT COMDME,POSDME,TIPDME,NOTDME FROM FILE_II.II_DTMEM WHERE COMDME = '49036' ORDER BY COMDME,POSDME
WITH RNCCQ AS (SELECT COMCQR,POSCQR FROM FILE_II.II_CQRNC WHERE NOTCQR NOT LIKE 'Trax%' GROUP BY COMCQR, POSCQR),IMBALLI AS (select tdomsr,ndomsr,RIGMSR,max(stamsr) as STAMSR, max(STAMSI) as STAMSI,SUM(QTAMSR) AS QTAIMB FROM FILE_II.II_MSRIG LEFT JOIN FILE_II.II_MSIMB ON PRGMSR = PRGMSI group by tdomsr,ndomsr,RIGMSR), MAT AS (SELECT COMDIS,PASDIS,MIN(DSPDIS) AS MAT_DSPDIS,MAX(CODDIS) AS MAT_CODDIS, MAX(MAGDIS) AS MAT_MAGDIS  FROM FILE_II.II_DTECN MAT  WHERE MAT.ANNDIS = ' ' AND ((MAT.TPADIS='P' AND MAT.TLIDIS='G')OR (MAT.TPADIS = 'F' AND MAT.TLIDIS = 'F') OR (MAT.TPADIS = 'A' AND MAT.TLIDIS = ' ') OR (MAT.TPADIS = 'A' AND MAT.TLIDIS = 'V') OR (MAT.TPADIS = 'C')OR (MAT.TPADIS = 'P' AND MAT.TLIDIS = 'F')) GROUP BY COMDIS,PASDIS), LAVMEC AS (SELECT COMDIS,PASDIS,MAX(DPIDIS) AS LM_DPIDIS FROM FILE_II.II_DTECN LM WHERE LM.CCIDIS BETWEEN 401 AND 469 AND LM.PRIDIS<>0 AND LM.PRIDIS<>900 AND LM.FCODIS<>'F' AND LM.DPIDIS>'1900-01-01' AND ' ' = LM.ANNDIS GROUP BY LM.COMDIS,LM.PASDIS) , CONTROLLI AS (SELECT 'C' AS CONTROLLO, COMDIS, PASDIS FROM FILE_II.II_DTECN WHERE CRIDIS = 1 AND ANNDIS = ' ' GROUP BY COMDIS, PASDIS) , RF_IMB AS (SELECT COMRIG,PCORIG,MIN(EVARIG) AS EVARIG FROM FILE_II.II_RIGOF JOIN FILE_II.II_PARTI PARTI_RF ON PARTI_RF.CODPAR=CODRIG AND PARTI_RF.ANNPAR='' AND PARTI_RF.TPAPAR='I' JOIN FILE_II.II_TABNC ON ANNTNC = '' AND TRETNC = 'DO' AND SUBSTR(CODTNC, 12, 2) =  DIGITS(TDORIG) AND SUBSTR(DATTNC, 80, 1)= '' AND SUBSTR(DATTNC, 45, 1) = '2' WHERE ANNRIG='' group by COMRIG,PCORIG), PKLIST AS (SELECT min(dorord) as DATAPKLIST,keorig,rorrig FROM FILE_II.II_RIGBO JOIN FILE_II.II_MODBO on magord = tdorig and ordord = nudrig and or2ord = znorig and annord='' WHERE nplord <> 0 and ANNRIG='' AND TIPRIG=2 GROUP BY keorig,rorrig), RIGA_RICHAPP AS (SELECT COMRAP,POSRAP,SUM(QTARAP) AS QTARAP FROM FILE_II.II_RIGAP WHERE ANNRAP='' group by COMRAP,POSRAP), NOTE_PRESENZ AS (SELECT TDORIF,ORDRIF,NRIRIF,MAX(NO1RIF) AS NO1RIF FROM FILE_II.II_RIGIF WHERE NUMRIF IN (80,82) AND ANNRIF='' AND NO1RIF<>'' AND OR2RIF=0 GROUP BY TDORIF,ORDRIF,NRIRIF) SELECT RC.TDORIG,RC.NUDRIG,RC.ZNORIG,RC.PRGRIG,RC.TIPRIG,RC.PRIRIG,RC.EVARIG,RC.DCORIG,RC.DPRRIG,RC.COMRIG,RC.PCORIG,RC.CLIRIG,RC.DES1,RC.DES2,RC.DES3,RC.QTARIG,RC.QTA2,RC.QTA3,RC.UMMRIG,RC.UM2RIG,RC.CCURIG,RC.PSURIG,RC.ITERIG,RC.SBLRIG,RC.NCORIG,RC.COLRIG,RC.ROORIG,RC.CODRIG,RC.MAGRIG,RC.DSBRIG,RC.DUBRIG,RC.SP1RIG,RC.PRZRIG,RC.SC1RIG,RC.SC2RIG,RC.SC3RIG,RC.USFRIG,RC.MPIRIG,RC.LPFRIG,RC.PMIRIG,RC.VISRIG,RC.CFTRIG,RC.DDARIG,RC.IMSRIG,RC.CDSRIG,RC.RGTRIG,DORORD,CPRORD,AGEORD,AG2ORD,VSOORD,DOCORD,PENORD,P.PSFPAR,P.UM2PAR,P.CCOPAR,P.RMEPAR,P.DE1PAR,P.DE2PAR,P.DE3PAR,P.CCOPAR,P.MATPAR,P.DIMPAR,P.TIPPAR,P.PRNPAR,P.RIFPAR,P.SCHPAR,P.TCOPAR,RSOANA, FIDANS, ASSANS, CPGANS, POSCLI,NOBRMO,NOARMO,NOIRMO,POSCQR,UFAGRU,DUFGRU,DMPGRU,ESPGRU,IMBALLI.RIGMSR AS IMBALLI_RIGMSR,IMBALLI.STAMSR AS IMBALLI_STAMSR,IMBALLI.STAMSI AS IMBALLI_STAMSI,IMBALLI.QTAIMB AS IMBALLI_QTAIMB,PRIMO.FCODIS AS PRIMO_FCODIS, PRIMO.LANDIS AS PRIMO_LANDIS,PRIMO.TLIDIS AS PRIMO_TLIDIS, PRIMO.DINDIS AS PRIMO_DINDIS,PRIMO.DSPDIS AS PRIMO_DSPDIS,MAT_DSPDIS, MAT_CODDIS, MAT_MAGDIS,NOTEPRIMO.NOTDME AS NOTEPRIMO_NOTDME,R20.NO1RIF AS R20_NO1RIF,R20.NO2RIF AS R20_NO2RIF,R20.NO3RIF AS R20_NO3RIF,R20.NO4RIF AS R20_NO4RIF,R20.NO5RIF AS R20_NO5RIF,R20.NO6RIF AS R20_NO6RIF,R20.NO7RIF AS R20_NO7RIF,R20.NO8RIF AS R20_NO8RIF,LM_DPIDIS,RF_IMB.EVARIG AS RF_EVARIG,QTARAP, CONTROLLO, DATAPKLIST,R70.NO1RIF AS R70_NO1RIF,NOTE_PRESENZ.NO1RIF AS NOTE_PRESENZ_NO1RIF FROM FILE_II.II_RIGOC RC  JOIN FILE_II.II_MODOC ON RC.TDORIG=MAGORD AND RC.NUDRIG=ORDORD AND RC.ZNORIG=OR2ORD AND ' '=ANNORD  JOIN FILE_II.II_ANAGR A ON RC.CLIRIG = CODANA AND ANNANA='' AND TREANA = 1 LEFT JOIN FILE_II.II_ANASU AS ASU ON A.TREANA=ASU.TREANS AND A.CODANA=ASU.CODANS AND ASU.ANNANS = '' LEFT JOIN FILE_II.II_CLIPO AS NOMINATIVI ON A.TREANA=TRECLI AND A.CODANA=CODCLI AND ASPCLI='' AND ANNCLI='' LEFT JOIN FILE_II.II_PARTI AS P ON RC.CODRIG = P.CODPAR AND P.ANNPAR = '' LEFT JOIN FILE_II.II_RIGMO ON tdormo=RC.TDORIG and nudrmo=RC.NUDRIG and znormo=RC.ZNORIG and prgrmo=RC.PRGRIG and prvrmo NOT IN ('FC','FF','RF') LEFT JOIN RNCCQ ON RC.COMRIG=RNCCQ.COMCQR AND RC.PRGRIG=RNCCQ.POSCQR LEFT  JOIN FILE_II.II_DTECN PRIMO ON PRIMO.COMDIS=RC.COMRIG AND PRIMO.POSDIS=RC.PRGRIG AND PRIMO.ANNDIS='' LEFT JOIN FILE_II.II_DTMEM NOTEPRIMO ON NOTEPRIMO.COMDME=PRIMO.COMDIS AND NOTEPRIMO.POSDME=PRIMO.POSDIS AND NOTEPRIMO.TIPDME='NT' LEFT JOIN FILE_II.II_COMGR  ON RC.COMRIG=KCOGRU AND RC.PCORIG=KPRGRU AND ANNGRU='' LEFT JOIN IMBALLI ON IMBALLI.tdomsr=RC.TDORIG AND IMBALLI.ndomsr=RC.NUDRIG AND IMBALLI.RIGMSR=RC.PRGRIG LEFT JOIN FILE_II.II_RIGIF R20 ON R20.ANNRIF='' AND R20.TDORIF=RC.TDORIG AND R20.ORDRIF=RC.NUDRIG AND R20.OR2RIF=0 AND R20.NRIRIF=0 AND R20.NUMRIF=20 LEFT JOIN MAT  ON PRIMO.COMDIS = MAT.COMDIS AND PRIMO.POSDIS=MAT.PASDIS LEFT JOIN LAVMEC  ON PRIMO.COMDIS = LAVMEC.COMDIS AND PRIMO.POSDIS=LAVMEC.PASDIS AND SUBSTR(PRIMO.CODDIS,1,1)<>'R' AND PRIMO.TPADIS<>'T' LEFT  JOIN FILE_II.II_RIGIF R70 ON R70.ANNRIF='' AND R70.TDORIF=RC.TDORIG AND R70.ORDRIF=RC.NUDRIG AND R70.OR2RIF=0 AND R70.NRIRIF=RC.PRGRIG AND R70.NUMRIF=70 LEFT JOIN NOTE_PRESENZ ON NOTE_PRESENZ.TDORIF=RC.TDORIG AND NOTE_PRESENZ.ORDRIF=RC.NUDRIG AND NOTE_PRESENZ.NRIRIF=RC.PRGRIG LEFT JOIN RF_IMB ON RF_IMB.COMRIG=RC.COMRIG AND RF_IMB.PCORIG=RC.PRGRIG LEFT JOIN RIGA_RICHAPP ON CHAR(RC.NUDRIG)=COMRAP AND RC.PRGRIG=POSRAP LEFT JOIN CONTROLLI  ON PRIMO.COMDIS = CONTROLLI.COMDIS AND PRIMO.POSDIS = CONTROLLI.PASDIS LEFT JOIN PKLIST  ON (DIGITS(RC.tdorig)||DIGITS(RC.nudrig)||DIGITS(RC.znorig) = PKLIST.KEORIG) AND PKLIST.RORRIG=RC.prgrig WHERE RC.TIPRIG = 2 AND (  (RC.EVARIG <> 'E' AND IMPORD = ' ' ) ) AND (RC.CODRIG LIKE 'CA030W015%') AND (RC.ANNRIG = ' ') ORDER BY  RC.TDORIG,RC.NUDRIG,RC.PRGRIG OPTIMIZE FOR 501 ROWS
SELECT CODADT,NOTADT FROM FILE_II.II_ALLDT WHERE CODADT IN ('48757', '47949', '48715', '48663', '47969', '48408', '48405', '48230', '47659', '48680', '48402', '48213', '48156', '48849', '48210', '48963', '48686', '48589', '48863', '48463', '48399', '48720', '44959', '48283', '48105', '48286', '48267', '48049', '48262', '48281', '48531', '48916', '48221', '48918', '47745', '48853', '48659') AND (POSADT = 0) AND (TIPADT = 'CO') ORDER BY TIPADT,CODADT,POSADT,SEQADT,RIGADT
select codana,rsoana from FILE_II.II_anagr where codana in (select CPGANS from FILE_II.II_anasu where CPGANS>0 and treans=1 and annans='' group by treans,CPGANS) and annana='' and treana=1 order by rsoana,codana
CREATE TABLE QTEMP.CP (COMMESSA CHAR(8), POSIZIONE DEC(4, 0))
DELETE FROM QTEMP.CP
SELECT * FROM FILE_II.II_RIGIF WHERE COMRIF = '48156' AND (POSRIF = 9085) AND (ANNRIF = ' ') ORDER BY TDORIF, ORDRIF, NRIRIF
 WITH q(COMDIS,POSDIS,SEQDIS,TIPDIS,PASDIS,ASSDIS,CODDIS,CCIDIS,LANDIS,FCODIS,DPIDIS,DPFDIS,PRIDIS,QTADIS,NPZDIS,QTTDIS,UMMDIS,DCODIS,CDCDIS,QTCDIS,NPCDIS,TPADIS,TLIDIS,NBNDIS,MAGDIS,DINDIS,level) AS ( SELECT h.COMDIS,h.POSDIS,h.SEQDIS,h.TIPDIS,h.PASDIS,h.ASSDIS,h.CODDIS,h.CCIDIS,h.LANDIS,h.FCODIS,h.DPIDIS,h.DPFDIS,h.PRIDIS,h.QTADIS,h.NPZDIS,h.QTTDIS,h.UMMDIS,h.DCODIS,h.CDCDIS,h.QTCDIS,h.NPCDIS,h.TPADIS,h.TLIDIS,h.NBNDIS,h.MAGDIS,h.DINDIS, 1 AS level FROM FILE_II.II_dtecn h WHERE  h.posdis=100 and h.comdis='48105' and h.anndis='' UNION ALL SELECT hp.COMDIS,hp.POSDIS,hp.SEQDIS,hp.TIPDIS,hp.PASDIS,hp.ASSDIS,hp.CODDIS,hp.CCIDIS,hp.LANDIS,hp.FCODIS,hp.DPIDIS,hp.DPFDIS,hp.PRIDIS,hp.QTADIS,hp.NPZDIS,hp.QTTDIS,hp.UMMDIS,hp.DCODIS,hp.CDCDIS,hp.QTCDIS,hp.NPCDIS,hp.TPADIS,hp.TLIDIS,hp.NBNDIS,hp.MAGDIS,hp.DINDIS, level + 1 FROM q JOIN FILE_II.II_dtecn hp ON hp.pasdis = q.posdis and hp.comdis=q.comdis and hp.anndis='' ) SELECT COMDIS,POSDIS,SEQDIS,TIPDIS,PASDIS,ASSDIS,CODDIS,CCIDIS,LANDIS,FCODIS,DPIDIS,DPFDIS,PRIDIS,QTADIS,NPZDIS,QTTDIS,UMMDIS,DCODIS,CDCDIS,QTCDIS,NPCDIS,TPADIS,TLIDIS,NBNDIS,MAGDIS,DINDIS,level,P.de1par,P.de2par,P.de3par,P.DESPAR FROM q left join FILE_II.II_parti P on P.annpar='' and P.codpar=q.coddis ORDER BY comdis,PASDIS,SEQDIS,POSDIS
SELECT * FROM FILE_II.II_PIACO WHERE ESEPCO=2013 AND ANNPCO='' ORDER BY MASPCO, GRUPCO, CONPCO, SOTPCO
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT  MASREG AS MASTRO, GRUREG AS GRUPPO, CONREG AS CONTO, SOTREG AS SOTTOCONTO, MAX(DESPCO) AS DESCRCONTO, sum(case PRVREG when 'A' then 1 else 0 end) as NUMAPERTURE, sum(case DAVREG||PRVREG when 'DA' then EURREG else 0 end) as TOTDARE_APERT, sum(case DAVREG||PRVREG when 'AA' then EURREG else 0 end) as TOTAVERE_APERT, sum(case DAVREG||PRVREG when 'DA' then IMVREG else 0 end) as TOTDAREVALUTA_APERT, sum(case DAVREG||PRVREG when 'AA' then IMVREG else 0 end) as TOTAVEREVALUTA_APERT, sum(case DAVREG when 'D' then EURREG else 0 end) as TOTDARE, sum(case DAVREG when 'A' then EURREG else 0 end) as TOTAVERE, sum(case DAVREG when 'D' then IMVREG else 0 end) as TOTDAREVALUTA, sum(case DAVREG when 'A' then IMVREG else 0 end) as TOTAVEREVALUTA FROM FILE_II.II_REGIS LEFT JOIN FILE_II.II_PIACO ON ANNPCO='' AND LIVPCO=4 AND ACOREG=ESEPCO AND MASREG=MASPCO AND GRUREG=GRUPCO AND CONREG=CONPCO AND SOTREG=SOTPCO WHERE ANNREG = ' ' AND TIPREG = 1 AND RIOREG = ' 'AND ACOREG = 2013 AND DATREG <= 20141217 AND PRVREG <> 'C' AND PRVREG <> 'P'  AND PRVREG <> 'N'  group by MASREG,GRUREG,CONREG,SOTREG order by MASTRO,GRUPPO,CONTO,SOTTOCONTO 
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
with APERTURE AS(SELECT DISTINCT MASREG,GRUREG,CONREG,SOTREG FROM FILE_II.II_REGIS WHERE ANNREG=' ' AND PRVREG='A' AND ACOREG=2013) ,righevalide2 as(SELECT DISTINCT NW1PCO,NW2PCO,NW3PCO,NW4PCO,TCOPCO,DESPCO FROM  FILE_II.II_REGIS R2 LEFT JOIN FILE_II.II_PIACO ON LIVPCO = 4 AND ANNPCO = ' '  AND ESEPCO=2013 AND R2.MASREG = MASPCO AND R2.GRUREG = GRUPCO AND R2.CONREG = CONPCO AND R2.SOTREG = SOTPCO  LEFT JOIN APERTURE ON R2.MASREG=APERTURE.MASREG AND R2.GRUREG=APERTURE.GRUREG AND R2.CONREG=APERTURE.CONREG AND R2.SOTREG=APERTURE.SOTREG WHERE APERTURE.MASREG IS NULL AND ((TCOPCO IS NULL) OR(TCOPCO IN ('A','P'))) AND R2.ANNREG=' ' AND ACOREG = 2012) (select R.MASREG,R.GRUREG,R.CONREG,R.SOTREG,max(TCOPCO) as TCOPCO,max(DESPCO) as DESPCO, sum(case DAVREG when 'D' then EURREG else 0 end) as TOTDARE, sum(case DAVREG when 'A' then EURREG else 0 end) as TOTAVERE, sum(case DAVREG when 'D' then IMVREG else 0 end) as TOTDAREVALUTA, sum(case DAVREG when 'A' then IMVREG else 0 end) as TOTAVEREVALUTA,max(VALREG) as VALREG FROM FILE_II.II_REGIS R LEFT JOIN APERTURE ON R.MASREG=APERTURE.MASREG AND R.GRUREG=APERTURE.GRUREG AND R.CONREG=APERTURE.CONREG AND R.SOTREG=APERTURE.SOTREG LEFT JOIN FILE_II.II_PIACO ON LIVPCO = 4 AND ANNPCO = ' ' AND R.ACOREG=ESEPCO AND R.MASREG = MASPCO AND R.GRUREG = GRUPCO AND R.CONREG = CONPCO AND R.SOTREG = SOTPCO WHERE ANNREG = ' ' AND TIPREG = 1  and PRVREG <= 'C'  AND APERTURE.MASREG IS NULL AND ACOREG = 2012 AND ((TCOPCO IS NULL) OR(TCOPCO IN ('A','P'))) AND RIOREG = ' '  GROUP BY R.MASREG,R.GRUREG,R.CONREG,R.SOTREG) UNION (select R.MASREG,R.GRUREG,R.CONREG,R.SOTREG,max(TCOPCO) as TCOPCO,max(DESPCO) as DESPCO, sum(case DAVREG when 'D' then EURREG else 0 end) as TOTDARE, sum(case DAVREG when 'A' then EURREG else 0 end) as TOTAVERE, sum(case DAVREG when 'D' then IMVREG else 0 end) as TOTDAREVALUTA, sum(case DAVREG when 'A' then IMVREG else 0 end) as TOTAVEREVALUTA,max (R.VALREG) as VALREG FROM FILE_II.II_REGIS R INNER JOIN righevalide2 RV2 ON  R.MASREG=RV2.NW1PCO AND R.GRUREG=RV2.NW2PCO AND R.CONREG=RV2.NW3PCO AND R.SOTREG=RV2.NW4PCO  WHERE ANNREG = ' ' AND TIPREG = 1  and PRVREG <= 'C'  AND ACOREG = 2012 GROUP BY R.MASREG,R.GRUREG,R.CONREG,R.SOTREG) order by MASREG,GRUREG,CONREG,SOTREG
SELECT NUMREG FROM FILE_II.II_REGIS LEFT JOIN FILE_II.II_PIACO ON ANNPCO='' AND LIVPCO=4 AND ACOREG=ESEPCO AND MASREG=MASPCO AND GRUREG=GRUPCO AND CONREG=CONPCO AND SOTREG=SOTPCO  LEFT JOIN FILE_II.II_CONTT ON NUMCTT=NUMREG WHERE (ANNREG = 'T' OR USRCTT <> ' ') AND TIPREG = 1 AND RIOREG = ' 'AND ACOREG = 2013 AND DATREG <= 20141217 AND PRVREG <> 'C' AND PRVREG <> 'P'  AND PRVREG <> 'N' 
WITH ALLEGATI AS ( SELECT CAST(left(digits(PRGAAL), 2) as NUMERIC) as TIPOALL, CAST(substr(digits(PRGAAL), 3) as NUMERIC) as NUMEROALL FROM FILE_II.II_ASSAL WHERE DIVAAL='JO' GROUP BY PRGAAL) SELECT ORDINI.*,A.TREANA AS TREANA,A.RSOANA AS RSOANA,A.NMGANA AS NMGANA,A.PROANA AS PROANA,NOBRMO,NOARMO,NOIRMO,TC1RMO,TC2RMO,TC3RMO,TC4RMO,CPGANS,TIPOALL, NUMEROALL,RS1DSP,RS2DSP,LOCDSP,NOMINATIVI.RS1CLI FROM FILE_II.II_MODOC ORDINI  LEFT JOIN FILE_II.II_RIGMO ON TDORMO=MAGORD AND NUDRMO=ORDORD AND ZNORMO=OR2ORD AND PRGRMO=0 AND PRVRMO NOT IN ('FC','FF','RF') LEFT JOIN ALLEGATI ON MAGORD = TIPOALL AND ORDORD=NUMEROALL LEFT JOIN FILE_II.II_ANAGR AS A ON CLIORD = A.CODANA AND A.ANNANA='' AND A.TREANA = 1 LEFT JOIN FILE_II.II_ANASU AS ASU ON A.TREANA=ASU.TREANS AND A.CODANA=ASU.CODANS AND ASU.ANNANS = '' JOIN FILE_II.II_TABNC T ON T.ANNTNC = '' AND T.TRETNC = 'DO' AND SUBSTR(T.CODTNC, 12, 2) =  DIGITS(MAGORD) AND SUBSTR(T.DATTNC, 45, 1)= '1'AND SUBSTR(T.DATTNC, 80, 1)= '' LEFT JOIN FILE_II.II_MOCSP ON MAGDSP = MAGORD AND ORDDSP = ORDORD AND OR2DSP = OR2ORD AND ANNDSP = ' ' LEFT JOIN FILE_II.II_CLIPO AS NOMINATIVI ON PRGCLI=CNOORD AND SIGCLI=TNOORD AND ANNCLI='' WHERE EVAORD <> 'E' AND (OR2ORD = 0) AND (ANNORD = ' ') ORDER BY MAGORD,ORDORD OPTIMIZE FOR 501 ROWS
select codana,rsoana from FILE_II.II_anagr where codana in (select CPGANS from FILE_II.II_anasu where CPGANS>0 and treans=1 and annans='' group by treans,CPGANS) and annana='' and treana=1 order by rsoana,codana
SELECT * FROM FILE_II.II_ANAGR LEFT JOIN FILE_II.II_ANASU ON TREANA = TREANS AND CODANA = CODANS AND ANNANS = ' ' LEFT JOIN FILE_II.II_CLIPO ON TREANA = TRECLI AND CODANA = CODCLI AND ASPCLI = ' ' AND ANNCLI = ' 'LEFT JOIN MFA400.AA_ABI ON ABIANS = CODABI LEFT JOIN MFA400.AA_CAB ON ABIANS = ABICAB AND CABANS = CABCAB WHERE TREANA = 1 AND (  (RSOANA LIKE '%VAN%' OR NMGANA LIKE '%VAN%' ) ) AND (ANNANA = ' ') AND (  (TREANA IS NULL OR TREANA <> 2 OR RISANA <> 'R' ) ) ORDER BY TREANA,CODANA OPTIMIZE FOR 501 ROWS
select codana,rsoana from FILE_II.II_anagr where codana in (select CPGANS from FILE_II.II_anasu where CPGANS>0 and treans=1 and annans='' group by treans,CPGANS) and annana='' and treana=1 order by rsoana,codana
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
WITH CAUSALI AS (SELECT * FROM FILE_II.II_TABRU WHERE TIPTAB = 'CA'  AND ANNTAB = ' ' ), PARTITEPAREGGIATE AS (SELECT MASREG, GRUREG, CONREG, SOTREG, PARREG AS PARPAR,'1' AS PAREGGIATA,MIN(DATREG) AS MINDATREG FROM FILE_II.II_REGIS WHERE MASREG=1 AND GRUREG=4 AND CONREG=10 AND SOTREG=695 AND ANNREG = ' ' AND TIPREG = 1 AND PARREG > 0   GROUP BY MASREG, GRUREG, CONREG, SOTREG,PARREG HAVING (SUM(CASE DAVREG WHEN 'D' THEN EURREG ELSE 0 END) <> SUM(CASE DAVREG WHEN 'A' THEN EURREG ELSE 0 END) )) SELECT R.NUMREG, R.PRVREG, R.DDOREG, R.NDOREG, R.NPRREG, R.DCOREG, R.PAGREG, R.WSTREG, R.USRREG, R.ACOREG, R.DATREG, R.CTSREG, R.MCOREG, R.VISREG, R.CAUREG AS CAUSALE, R.CLIREG AS CLIENTE, RSOANA AS RAGIONESOC, NMGANA AS NOMIGNOLO, CCOANA,PROANA AS PROVINCIA, ESTANA AS TIPOSOGGETTO, CASE WHEN C1.DATTAB IS NULL THEN TRIM(LEFT(C2.DATTAB, 35)) ELSE TRIM(LEFT(C1.DATTAB, 35)) END AS DESCAUSALE,SUBSTR(C2.DATTAB, 55, 2) AS TIPOPROTOCOLLO,SUBSTR(C2.DATTAB,94,1) AS MOVDIFCAMBIO, R.NRIREG, R.TIPREG, R.MASREG, R.GRUREG, R.CONREG, R.SOTREG, R.PARREG, R.DAVREG, R.IMVREG, R.VALREG, R.COMREG, R.EURREG, R.DE1REG, R.CA2REG, R.DE2REG, R.DE3REG, R.NRGREG, R.FL2REG, R.FL3REG, R.BILREG, R.DVAREG, R.CDCREG, DESPCO AS DESCR,TCOPCO AS TCOPCO,PAREGGIATA FROM FILE_II.II_REGIS R  LEFT JOIN FILE_II.II_ANAGR ON ANNANA = ' ' AND SUBSTR(DIGITS(R.CLIREG), 1, 1) = DIGITS(TREANA) AND SUBSTR(DIGITS(R.CLIREG), 2, 6) = DIGITS(CODANA)  LEFT JOIN FILE_II.II_ANASU ON ANNANS = ' ' AND TREANA = TREANS AND CODANA = CODANS LEFT JOIN CAUSALI C1 ON CAST(SUBSTR(C1.CODTAB,11,3) AS INT) = R.CAUREG AND SUBSTR(C1.CODTAB,7,2) = LINANS  LEFT JOIN CAUSALI C2 ON CAST(SUBSTR(C2.CODTAB,11,3) AS INT) = R.CAUREG AND SUBSTR(C2.CODTAB,7,2) = '  '  LEFT JOIN FILE_II.II_PIACO ON ANNPCO='' AND LIVPCO=4 AND R.ACOREG=ESEPCO AND R.MASREG=MASPCO AND R.GRUREG=GRUPCO AND R.CONREG=CONPCO AND R.SOTREG=SOTPCO JOIN PARTITEPAREGGIATE PP ON  R.MASREG = PP.MASREG AND R.GRUREG = PP.GRUREG AND R.CONREG = PP.CONREG AND R.SOTREG = PP.SOTREG AND R.PARREG = PARPAR  WHERE R.ANNREG = ' ' AND (R.TIPREG = 1) AND (R.PRVREG <> 'A') AND (R.PRVREG <> 'C') AND (R.MASREG = 1) AND (R.GRUREG = 4) AND (R.CONREG = 10) AND (R.SOTREG = 695) AND (R.PARREG > 0) AND (R.PRVREG <> 'N') AND (R.PRVREG <> 'P') ORDER BY R.MASREG,R.GRUREG,R.CONREG,R.SOTREG,MINDATREG,R.PARREG,R.DATREG,R.ACOREG, R.DATREG, R.NUMREG, R.NRIREG
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT * FROM FILE_II.II_ANAGR LEFT JOIN FILE_II.II_ANASU ON TREANA = TREANS AND CODANA = CODANS AND ANNANS = ' ' LEFT JOIN FILE_II.II_CLIPO ON TREANA = TRECLI AND CODANA = CODCLI AND ASPCLI = ' ' AND ANNCLI = ' 'LEFT JOIN MFA400.AA_ABI ON ABIANS = CODABI LEFT JOIN MFA400.AA_CAB ON ABIANS = ABICAB AND CABANS = CABCAB WHERE TREANA = 1 AND (ANNANA = ' ') AND (  (TREANA IS NULL OR TREANA <> 2 OR RISANA <> 'R' ) ) ORDER BY TREANA,CODANA OPTIMIZE FOR 501 ROWS
select codana,rsoana from FILE_II.II_anagr where codana in (select CPGANS from FILE_II.II_anasu where CPGANS>0 and treans=1 and annans='' group by treans,CPGANS) and annana='' and treana=1 order by rsoana,codana
SELECT * FROM FILE_II.II_ANAGR LEFT JOIN FILE_II.II_ANASU ON TREANA = TREANS AND CODANA = CODANS AND ANNANS = ' ' LEFT JOIN FILE_II.II_CLIPO ON TREANA = TRECLI AND CODANA = CODCLI AND ASPCLI = ' ' AND ANNCLI = ' 'LEFT JOIN MFA400.AA_ABI ON ABIANS = CODABI LEFT JOIN MFA400.AA_CAB ON ABIANS = ABICAB AND CABANS = CABCAB WHERE TREANA = 1 AND (CODANA = 474) AND (ANNANA = ' ') AND (  (TREANA IS NULL OR TREANA <> 2 OR RISANA <> 'R' ) ) ORDER BY TREANA,CODANA OPTIMIZE FOR 1 ROWS
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '1'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '2'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '3'
SELECT DATTAB FROM FILE_II.II_TABRU WHERE TIPTAB = 'DC' AND ANNTAB = ' ' AND TRIM(BOTH FROM CODTAB) = '6'
SELECT * FROM FILE_II.II_PIACO WHERE ESEPCO = 2013 AND (UPPER((DIGITS(MASPCO) || DIGITS(GRUPCO) || DIGITS(CONPCO) || DIGITS(SOTPCO))) IN ('010410000000')) AND (ANNPCO = ' ') ORDER BY MASPCO,GRUPCO,CONPCO,SOTPCO
SELECT CE.*,TRECLI,CODCLI,DESAMO FROM FILE_II.II_CLIPE CE  INNER JOIN FILE_II.II_CLIPO ON SIGCLI = SIGPER AND PRGCLI = NOMPER AND ANNCLI = ' ' LEFT JOIN FILE_II.II_ANAMO ON TRECLI = TPAAMO AND CODCLI = CDAAMO AND KPRPER = PRGAMO WHERE TRECLI = 1 AND (CODCLI = 474) AND (ASPCLI = ' ') AND (ANNPER = ' ') ORDER BY SIGPER, NOMPER, KPRPER
SELECT * FROM FILE_II.II_ANASC WHERE TREASC = 1 AND (CCLASC = 474) ORDER BY TREASC,CCLASC,RMEASC
SELECT FILE_II.II_ANASP.*, RSOANA FROM FILE_II.II_ANASP  LEFT JOIN FILE_II.II_ANAGR ON TREANA = TREASP AND CODANA = CODASP AND ANNANA = ' ' WHERE TREASP = 1 AND (CODASP = 474) AND (ANNASP = ' ') AND (  (TREANA IS NULL OR TREANA <> 2 OR RISANA <> 'R' ) ) ORDER BY TREASP,CODASP,PRGASP
SELECT * FROM FILE_II.II_ANAOL WHERE TREAOL = 1 AND (CODAOL = 474) AND (ANNAOL = ' ') ORDER BY TREAOL,CODAOL,DATAOL DESC
SELECT TIPACF,TI2ACF,TCFACF,CODACF,RIGACF,SEQACF,DORACF,OGGACF,EXTACF,NOTACF,MITACF,DSTACF,ANTACF,USRACF,LENGTH(BLBACF) AS LENBLOB,RSOANA FROM FILE_II.II_ALLCF INNER JOIN FILE_II.II_ANAGR ON ANNANA='' AND TREANA = TCFACF AND CODANA=CODACF WHERE   (TIPACF = 'XC' OR TIPACF = 'XF' )  AND (TCFACF = 1) AND (CODACF = 474) AND (  (TREANA IS NULL OR TREANA <> 2 OR RISANA <> 'R' ) ) ORDER BY TIPACF, TI2ACF, SEQACF, EXTACF, OGGACF, TIPACF,TCFACF,CODACF,SEQACF,RIGACF
SELECT * FROM FILE_II.II_CERTF WHERE CODCRF = 474 ORDER BY CODCRF,PRGCRF
SELECT FILE_II.II_ANASP.*, RSOANA FROM FILE_II.II_ANASP  LEFT JOIN FILE_II.II_ANAGR ON TREANA = TREASP AND CODANA = CODASP AND ANNANA = ' ' WHERE TREASP = 1 AND (ANNASP = ' ') AND (  (TREANA IS NULL OR TREANA <> 2 OR RISANA <> 'R' ) ) ORDER BY TREASP,CODASP,PRGASP OPTIMIZE FOR 501 ROWS
SELECT * FROM FILE_II.II_CQDIV ORDER BY KEYQDV
SELECT * FROM FILE_II.II_CQAUT ORDER BY KEYQUA,UTEQUA
SELECT * FROM FILE_II.II_CQDIV ORDER BY KEYQDV
SELECT * FROM FILE_II.II_DIP WHERE LICDIP = 0 AND (REQDIP = 1) ORDER BY DESDIP, KEYDIP
SELECT * FROM FILE_II.II_CDL ORDER BY KEYCDL
SELECT KEYCLV,DESCLV FROM FILE_II.II_CAULAV ORDER BY KEYCLV
WITH RIGHETT AS (SELECT PRGTTR, SUM(QTATTR) AS SUM_QTATTR, SUM(PTOTTR) AS SUM_PTOTTR FROM  FILE_II.II_TTRIG GROUP BY PRGTTR) SELECT * FROM FILE_II.II_TTMOD  LEFT JOIN RIGHETT ON PRGTTR=PRGTTM ORDER BY PRGTTM OPTIMIZE FOR 501 ROWS
WITH RIGHETT AS (SELECT COMTTR,POSTTR,SUM(QTATTR) AS SUM_QTATTR, SUM(PTOTTR) AS SUM_PTOTTR FROM  FILE_II.II_TTRIG GROUP BY COMTTR,POSTTR),CONTROLLI AS (SELECT 'C' AS CONTROLLO, COMDIS, PASDIS FROM FILE_II.II_DTECN WHERE CRIDIS = 1 AND ANNDIS = ' ' GROUP BY COMDIS, PASDIS),RICOL AS (SELECT KCORIC,PRGRIC,MAX(VISRIC) AS VISRIC FROM FILE_II.II_RICOL GROUP BY KCORIC, PRGRIC), NOTE_PRESENZ AS (SELECT TDORIF,ORDRIF,NRIRIF,MAX(NO1RIF) AS NO1RIF FROM FILE_II.II_RIGIF WHERE NUMRIF IN (80,82) AND ANNRIF='' AND NO1RIF<>'' AND OR2RIF=0 GROUP BY TDORIF,ORDRIF,NRIRIF) SELECT DT.COMDIS AS DT_COMDIS,DT.POSDIS AS DT_POSDIS,DT.PASDIS AS DT_PASDIS,DT.TPADIS AS DT_TPADIS,DT.TLIDIS AS DT_TLIDIS,DT.QTTDIS AS DT_QTTDIS,DT.QTCDIS AS DT_QTCDIS,DT.NPCDIS AS DT_NPCDIS,DT.QCODIS AS DT_QCODIS,DT.MAGDIS AS DT_MAGDIS,DT.NPZDIS AS DT_NPZDIS,DT.CCIDIS AS DT_CCIDIS,DT.CDCDIS AS DT_CDCDIS,DT.CDLDIS AS DT_CDLDIS,DT.NBODIS AS DT_NBODIS,DT.DCODIS AS DT_DCODIS,DT.DPIDIS AS DT_DPIDIS,DT.DPFDIS AS DT_DPFDIS,DT.FCODIS AS DT_FCODIS,DT.LANDIS AS DT_LANDIS,DT.DSPDIS AS DT_DSPDIS,DT.PRIDIS AS DT_PRIDIS,DT.PRRDIS AS DT_PRRDIS,DT.DINDIS AS DT_DINDIS,DT.CTRDIS AS DT_CTRDIS,DPAR.CODPAR AS DPAR_CODPAR,DPAR.DESPAR AS DPAR_DESPAR,DPAR.DE1PAR AS DPAR_DE1PAR,DPAR.DE2PAR AS DPAR_DE2PAR,DPAR.DE3PAR AS DPAR_DE3PAR,DPAR.UMMPAR AS DPAR_UMMPAR,DPAR.UM2PAR AS DPAR_UM2PAR,DPAR.CCOPAR AS DPAR_CCOPAR,DPAR.PSFPAR AS DPAR_PSFPAR,DPAR.SCHPAR AS DPAR_SCHPAR,DPAR.MATPAR AS DPAR_MATPAR,DPAR.DIMPAR AS DPAR_DIMPAR,DPAR.TIPPAR AS DPAR_TIPPAR,DPAR.PRNPAR AS DPAR_PRNPAR,DPAR.RIFPAR AS DPAR_RIFPAR,PAP.COMDIS AS PAP_COMDIS,PAP.POSDIS AS PAP_POSDIS,PAP.PASDIS AS PAP_PASDIS,PAP.TPADIS AS PAP_TPADIS,PAP.TLIDIS AS PAP_TLIDIS,PAP.QTTDIS AS PAP_QTTDIS,PAP.QTCDIS AS PAP_QTCDIS,PAP.NPCDIS AS PAP_NPCDIS,PAP.QCODIS AS PAP_QCODIS,PAP.MAGDIS AS PAP_MAGDIS,PAP.NPZDIS AS PAP_NPZDIS,PAP.CCIDIS AS PAP_CCIDIS,PAP.CDCDIS AS PAP_CDCDIS,PAP.CDLDIS AS PAP_CDLDIS,PAP.NBODIS AS PAP_NBODIS,PAP.DCODIS AS PAP_DCODIS,PAP.DPIDIS AS PAP_DPIDIS,PAP.DPFDIS AS PAP_DPFDIS,PAP.FCODIS AS PAP_FCODIS,PAP.LANDIS AS PAP_LANDIS,PAP.DSPDIS AS PAP_DSPDIS,PAP.PRIDIS AS PAP_PRIDIS,PAP.PRRDIS AS PAP_PRRDIS,PAP.DINDIS AS PAP_DINDIS,PAP.CTRDIS AS PAP_CTRDIS,PAPPAR.CODPAR AS PAPPAR_CODPAR,PAPPAR.DESPAR AS PAPPAR_DESPAR,PAPPAR.DE1PAR AS PAPPAR_DE1PAR,PAPPAR.DE2PAR AS PAPPAR_DE2PAR,PAPPAR.DE3PAR AS PAPPAR_DE3PAR,PAPPAR.UMMPAR AS PAPPAR_UMMPAR,PAPPAR.UM2PAR AS PAPPAR_UM2PAR,PAPPAR.CCOPAR AS PAPPAR_CCOPAR,PAPPAR.PSFPAR AS PAPPAR_PSFPAR,PAPPAR.SCHPAR AS PAPPAR_SCHPAR,PAPPAR.MATPAR AS PAPPAR_MATPAR,PAPPAR.DIMPAR AS PAPPAR_DIMPAR,PAPPAR.TIPPAR AS PAPPAR_TIPPAR,PAPPAR.PRNPAR AS PAPPAR_PRNPAR,PAPPAR.RIFPAR AS PAPPAR_RIFPAR,MAT.COMDIS AS MAT_COMDIS,MAT.POSDIS AS MAT_POSDIS,MAT.PASDIS AS MAT_PASDIS,MAT.TPADIS AS MAT_TPADIS,MAT.TLIDIS AS MAT_TLIDIS,MAT.QTTDIS AS MAT_QTTDIS,MAT.QTCDIS AS MAT_QTCDIS,MAT.NPCDIS AS MAT_NPCDIS,MAT.QCODIS AS MAT_QCODIS,MAT.MAGDIS AS MAT_MAGDIS,MAT.NPZDIS AS MAT_NPZDIS,MAT.CCIDIS AS MAT_CCIDIS,MAT.CDCDIS AS MAT_CDCDIS,MAT.CDLDIS AS MAT_CDLDIS,MAT.NBODIS AS MAT_NBODIS,MAT.DCODIS AS MAT_DCODIS,MAT.DPIDIS AS MAT_DPIDIS,MAT.DPFDIS AS MAT_DPFDIS,MAT.FCODIS AS MAT_FCODIS,MAT.LANDIS AS MAT_LANDIS,MAT.DSPDIS AS MAT_DSPDIS,MAT.PRIDIS AS MAT_PRIDIS,MAT.PRRDIS AS MAT_PRRDIS,MAT.DINDIS AS MAT_DINDIS,MAT.CTRDIS AS MAT_CTRDIS,MATPAR.CODPAR AS MATPAR_CODPAR,MATPAR.DESPAR AS MATPAR_DESPAR,MATPAR.DE1PAR AS MATPAR_DE1PAR,MATPAR.DE2PAR AS MATPAR_DE2PAR,MATPAR.DE3PAR AS MATPAR_DE3PAR,MATPAR.UMMPAR AS MATPAR_UMMPAR,MATPAR.UM2PAR AS MATPAR_UM2PAR,MATPAR.CCOPAR AS MATPAR_CCOPAR,MATPAR.PSFPAR AS MATPAR_PSFPAR,MATPAR.SCHPAR AS MATPAR_SCHPAR,MATPAR.MATPAR AS MATPAR_MATPAR,MATPAR.DIMPAR AS MATPAR_DIMPAR,MATPAR.TIPPAR AS MATPAR_TIPPAR,MATPAR.PRNPAR AS MATPAR_PRNPAR,MATPAR.RIFPAR AS MATPAR_RIFPAR,PRIMO.COMDIS AS PRIMO_COMDIS,PRIMO.POSDIS AS PRIMO_POSDIS,PRIMO.PASDIS AS PRIMO_PASDIS,PRIMO.TPADIS AS PRIMO_TPADIS,PRIMO.TLIDIS AS PRIMO_TLIDIS,PRIMO.QTTDIS AS PRIMO_QTTDIS,PRIMO.QTCDIS AS PRIMO_QTCDIS,PRIMO.NPCDIS AS PRIMO_NPCDIS,PRIMO.QCODIS AS PRIMO_QCODIS,PRIMO.MAGDIS AS PRIMO_MAGDIS,PRIMO.NPZDIS AS PRIMO_NPZDIS,PRIMO.CCIDIS AS PRIMO_CCIDIS,PRIMO.CDCDIS AS PRIMO_CDCDIS,PRIMO.CDLDIS AS PRIMO_CDLDIS,PRIMO.NBODIS AS PRIMO_NBODIS,PRIMO.DCODIS AS PRIMO_DCODIS,PRIMO.DPIDIS AS PRIMO_DPIDIS,PRIMO.DPFDIS AS PRIMO_DPFDIS,PRIMO.FCODIS AS PRIMO_FCODIS,PRIMO.LANDIS AS PRIMO_LANDIS,PRIMO.DSPDIS AS PRIMO_DSPDIS,PRIMO.PRIDIS AS PRIMO_PRIDIS,PRIMO.PRRDIS AS PRIMO_PRRDIS,PRIMO.DINDIS AS PRIMO_DINDIS,PRIMO.CTRDIS AS PRIMO_CTRDIS,PRIMOPAR.CODPAR AS PRIMOPAR_CODPAR,PRIMOPAR.DESPAR AS PRIMOPAR_DESPAR,PRIMOPAR.DE1PAR AS PRIMOPAR_DE1PAR,PRIMOPAR.DE2PAR AS PRIMOPAR_DE2PAR,PRIMOPAR.DE3PAR AS PRIMOPAR_DE3PAR,PRIMOPAR.UMMPAR AS PRIMOPAR_UMMPAR,PRIMOPAR.UM2PAR AS PRIMOPAR_UM2PAR,PRIMOPAR.CCOPAR AS PRIMOPAR_CCOPAR,PRIMOPAR.PSFPAR AS PRIMOPAR_PSFPAR,PRIMOPAR.SCHPAR AS PRIMOPAR_SCHPAR,PRIMOPAR.MATPAR AS PRIMOPAR_MATPAR,PRIMOPAR.DIMPAR AS PRIMOPAR_DIMPAR,PRIMOPAR.TIPPAR AS PRIMOPAR_TIPPAR,PRIMOPAR.PRNPAR AS PRIMOPAR_PRNPAR,PRIMOPAR.RIFPAR AS PRIMOPAR_RIFPAR,C.*,DES1,DES2,DES3,SBLRIG,DCORIG,DPRRIG,COLRIG,NCORIG,PRIRIG,SP1RIG,TDORIG,NUDRIG,ZNORIG,PRGRIG,PSURIG,UMMRIG,CPRORD,UFAGRU, DUFGRU, ANAG.NMGANA,NOTECICLO.NOTDME AS NOTECICLO_NOTDME,SUM_QTATTR,SUM_PTOTTR ,VISRIC,CONTROLLO,COALESCE(PSOOCC, 0)/PAP.QTTDIS AS PESO_PREV,NOTE_PRESENZ.NO1RIF AS NOTE_PRESENZ_NO1RIF FROM FILE_II.II_DTECN DT JOIN FILE_II.II_COMME C ON DT.COMDIS = C.KEYCOM AND ' ' = C.ANNCOM JOIN FILE_II.II_PARTI DPAR ON DT.CODDIS = DPAR.CODPAR AND ' ' = DPAR.ANNPAR JOIN FILE_II.II_DTECN  PAP ON PAP.ANNDIS = ' ' AND DT.COMDIS = PAP.COMDIS AND DT.PASDIS = PAP.POSDIS  JOIN FILE_II.II_PARTI PAPPAR ON PAP.CODDIS = PAPPAR.CODPAR AND ' ' = PAPPAR.ANNPAR LEFT  JOIN FILE_II.II_DTECN PRIMO ON PRIMO.COMDIS=DT.COMDIS  AND PRIMO.POSDIS=FILE_AM.MFPASS(PAP.COMDIS, PAP.POSDIS, PAP.PASDIS) AND PRIMO.ANNDIS='' LEFT JOIN FILE_II.II_PARTI PRIMOPAR ON PRIMO.CODDIS = PRIMOPAR.CODPAR AND ' ' = PRIMOPAR.ANNPAR  LEFT  JOIN FILE_II.II_DTECN MAT ON MAT.ANNDIS = ' ' AND DT.COMDIS = MAT.COMDIS AND DT.PASDIS = MAT.PASDIS AND ((MAT.TPADIS='P' AND MAT.TLIDIS='G')OR (MAT.TPADIS = 'F' AND MAT.TLIDIS = 'F') OR (MAT.TPADIS = 'A' AND MAT.TLIDIS = ' ') OR (MAT.TPADIS = 'A' AND MAT.TLIDIS = 'V') OR (MAT.TPADIS = 'C')OR (MAT.TPADIS = 'P' AND MAT.TLIDIS = 'F')) LEFT  JOIN FILE_II.II_PARTI MATPAR ON MATPAR.ANNPAR = ' ' AND MAT.CODDIS = MATPAR.CODPAR AND ' ' = MATPAR.ANNPAR LEFT JOIN FILE_II.II_DTMEM NOTECICLO ON NOTECICLO.COMDME=DT.COMDIS AND NOTECICLO.POSDME=DT.POSDIS AND NOTECICLO.TIPDME='NT' LEFT JOIN FILE_II.II_RIGOC RIGOC ON PRIMO.COMDIS = COMRIG AND PRIMO.POSDIS = PRGRIG AND ' ' = ANNRIG LEFT JOIN FILE_II.II_MODOC MODOC ON RIGOC.TDORIG=MODOC.MAGORD AND RIGOC.NUDRIG=MODOC.ORDORD AND ANNORD='' LEFT  JOIN RIGHETT ON COMTTR=DT.COMDIS AND POSTTR=DT.POSDIS LEFT JOIN FILE_II.II_ANAGR ANAG ON ANNANA='' AND CLICOM=CODANA AND TREANA=1 LEFT JOIN RICOL ON PRIMO.COMDIS = KCORIC AND PRIMO.POSDIS = PRGRIC LEFT JOIN FILE_II.II_DTLEG  ON COMDTL = PRIMO.COMDIS AND PODDTL = PRIMO.POSDIS and ANNDTL='' LEFT JOIN FILE_II.II_COMGR ON COMDTL = KCOGRU AND POCDTL = KPRGRU and ANNGRU='' LEFT JOIN CONTROLLI  ON PRIMO.COMDIS = CONTROLLI.COMDIS AND PRIMO.POSDIS = CONTROLLI.PASDIS LEFT JOIN FILE_AM.VC_PESOCC ON COMOCC = DT.COMDIS AND POSOCC = DT.PASDIS LEFT JOIN NOTE_PRESENZ ON NOTE_PRESENZ.TDORIF=RIGOC.TDORIG AND NOTE_PRESENZ.ORDRIF=RIGOC.NUDRIG AND NOTE_PRESENZ.NRIRIF=RIGOC.PRGRIG WHERE DT.CCIDIS BETWEEN 300 AND 311 AND (DT.FCODIS <= 'C') AND (DT.ANNDIS = ' ') AND (DT.CDCDIS NOT IN (495, 498, 499, 500, 541, 542, 543, 544, 545)) OPTIMIZE FOR 751 ROWS
SELECT * FROM FILE_II.II_TTRIG  INNER JOIN FILE_II.II_DTECN ON COMTTR = COMDIS AND RIGTTR = POSDIS INNER JOIN FILE_II.II_PARTI ON CODDIS = CODPAR INNER JOIN FILE_II.II_TTMOD ON PRGTTR  = PRGTTM LEFT JOIN FILE_II.II_RIGOC ON CHAR(NUDRIG) = COMTTR AND PRGRIG = RIGTTR LEFT JOIN FILE_II.II_RICOL R ON COMRIG = KCORIC AND PRGRIG = PRGRIC ORDER BY TDORIG,NUDRIG,ZNORIG,PRGRIG OPTIMIZE FOR 501 ROWS
